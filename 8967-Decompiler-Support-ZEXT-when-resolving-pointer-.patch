From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: hay-mon <234499490+hay-mon@users.noreply.github.com>
Date: Fri, 13 Feb 2026 15:48:11 +0000
Subject: [PATCH] 8967: Decompiler: Support ZEXT when resolving pointer
 arithmetic

---
 Ghidra/Features/Decompiler/src/decompile/cpp/ruleaction.cc | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/Ghidra/Features/Decompiler/src/decompile/cpp/ruleaction.cc b/Ghidra/Features/Decompiler/src/decompile/cpp/ruleaction.cc
index 4867f1d76d..3f72e21d5e 100644
--- a/Ghidra/Features/Decompiler/src/decompile/cpp/ruleaction.cc
+++ b/Ghidra/Features/Decompiler/src/decompile/cpp/ruleaction.cc
@@ -6317,6 +6317,8 @@ bool AddTreeState::checkTerm(Varnode *vn,uint8 treeCoeff)
     }
     if (def->code() == CPUI_INT_MULT)	// Check for constant coeff indicating size
       return checkMultTerm(vn, def, treeCoeff);
+    if (def->code() == CPUI_INT_ZEXT) // Recurse
+      return checkTerm(def->getIn(0), treeCoeff);
     if (def->code() == CPUI_INT_LEFT) {
       Varnode *shiftLeftByPtr = def->getIn(1);
       if (shiftLeftByPtr->isConstant()) {
-- 
2.45.1

