From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Prabhakar Jonnavithula <prabhakar.jonnavithula@mckesson.com>
Date: Fri, 5 Dec 2025 12:55:52 -0500
Subject: [PATCH] 8735: Feature: Improve Docker documentation

Improve Docker documentation

- Add comprehensive table of contents
- Add prerequisites and verification steps
- Enhance build instructions with manual options
- Add environment variables and port mapping reference
- Expand usage examples for all modes (headless, GUI, server, BSIM, PyGhidra)
- Add Docker Compose examples for multi-container setups
- Add extensive troubleshooting section
- Add security considerations and best practices
- Add performance tuning guidelines
- Add advanced topics (custom images, CI/CD integration, health checks)
- Add monitoring and debugging tips
- Add additional resources and help section
---
 .gitignore       |   6 +
 docker/README.md | 980 ++++++++++++++++++++++++++++++++++++++++++-----
 2 files changed, 881 insertions(+), 105 deletions(-)

diff --git a/.gitignore b/.gitignore
index 26f98578ea..e8adc4d57b 100644
--- a/.gitignore
+++ b/.gitignore
@@ -92,3 +92,9 @@ core.*
 # python files
 *.egg-info
 __pycache__
+
+# Ignore temporary PR and workflow instruction files
+FINAL_STEPS.md
+PR_INSTRUCTIONS.md
+PUSH_AND_PR.sh
+run_these_commands.sh
diff --git a/docker/README.md b/docker/README.md
index c621f9acc9..d6c906ef57 100644
--- a/docker/README.md
+++ b/docker/README.md
@@ -1,60 +1,181 @@
 # Dockerized Ghidra
 
-## Build
+This document provides comprehensive instructions for building, running, and managing Ghidra in Docker containers.
+
+## Table of Contents
+
+- [Prerequisites](#prerequisites)
+- [Quick Start](#quick-start)
+- [Building the Docker Image](#building-the-docker-image)
+- [Container Modes](#container-modes)
+- [Configuration](#configuration)
+- [Usage Examples](#usage-examples)
+- [Docker Compose](#docker-compose)
+- [Troubleshooting](#troubleshooting)
+- [Security Considerations](#security-considerations)
+- [Best Practices](#best-practices)
+- [Performance Tuning](#performance-tuning)
+- [Advanced Topics](#advanced-topics)
+
+## Prerequisites
+
+Before building and running Ghidra in Docker, ensure you have:
+
+- **Docker** version 20.10 or later installed and running
+- **Docker Compose** (optional, for multi-container setups) version 2.0 or later
+- A **built Ghidra release** (not source code) - the Docker image must be built from a release
+- Sufficient disk space (at least 5GB free for the image and build process)
+- On Linux: Appropriate permissions to run Docker commands (typically requires being in the `docker` group)
+
+### Verifying Docker Installation
+
+```bash
+docker --version
+docker info
+```
+
+## Quick Start
 
-From the root directory of your Ghidra release, run the following command.
+The fastest way to get started:
 
+```bash
+# From the root of your Ghidra release directory
+./docker/build-docker-image.sh
+
+# Run headless analysis
+docker run --rm \
+    --env MODE=headless \
+    --volume $(pwd)/myproject:/home/ghidra/myproject \
+    --volume $(pwd)/mybinary:/home/ghidra/mybinary \
+    ghidra/ghidra:<version> \
+    /home/ghidra/myproject programFolder -import /home/ghidra/mybinary
 ```
+
+## Building the Docker Image
+
+### Basic Build
+
+From the root directory of your Ghidra release, run:
+
+```bash
 ./docker/build-docker-image.sh
 ```
 
-This will build the ghidra docker image with a tag corresponding to the release version of Ghidra.
+This script will:
+1. Verify Docker is installed
+2. Check that you're in a built Ghidra release directory
+3. Extract version information from `Ghidra/application.properties`
+4. Build the Docker image with tag `ghidra/ghidra:<version>_<release>`
+
+### Manual Build
 
+If you prefer to build manually:
 
-## The MODE environment variable
+```bash
+# Get version information
+source <(sed 's/\.\|\(=.*\)/_\1/g;s/_=/=/' Ghidra/application.properties)
+VERSION=${application_version}
+RELEASE=${application_release_name}
+TAG=${VERSION}_${RELEASE}
+
+# Build the image
+docker build -f docker/Dockerfile -t ghidra/ghidra:$TAG .
+```
 
-The Ghidra Docker Container supports the following `MODE`'s of execution:
-- gui
-- headless
-- ghidra-server
-- bsim
-- bsim-server
-- pyghidra
+### Build Options
 
-The `MODE` environment variable designates which entrypoint of Ghidra to execute. 
+The Dockerfile uses multi-stage builds for optimization:
+- **base**: Minimal runtime dependencies
+- **build**: Build-time dependencies (Gradle, compilers, etc.)
+- **runtime**: Final optimized image
+
+### Verifying the Build
+
+After building, verify the image exists:
+
+```bash
+docker images | grep ghidra
+```
 
-The `entrypoint.sh` script is executed upon container startup.
+You should see an image tagged as `ghidra/ghidra:<version>_<release>`.
 
-## Configuring a Container
+## Container Modes
 
-Configuration of a container is done just as any other docker container would be configured. 
-Volumes can be mounted, environment variables can be set, ports can be mapped from container to the host, and so on.
-Configuration steps vary a lot based on what MODE the container is started with.
+The Ghidra Docker container supports multiple execution modes via the `MODE` environment variable:
 
-The base directory for Ghidra within the container is located at `/ghidra`. 
-All of ghidra's default locations for files, configs, etc., are the same within that.
-Ghidra is run as the user `ghidra` within the container, with uid `1001` and guid `1001`. 
+| Mode | Description | Use Case |
+|------|-------------|----------|
+| `headless` | Command-line analysis without GUI | Automated analysis, CI/CD pipelines |
+| `gui` | Graphical user interface | Interactive analysis (not recommended in Docker) |
+| `ghidra-server` | Ghidra Server for multi-user collaboration | Team environments, shared repositories |
+| `bsim` | Binary Similarity Indexing CLI | Generating and querying function signatures |
+| `bsim-server` | BSIM database server | Hosting BSIM PostgreSQL database |
+| `pyghidra` | Python-based Ghidra interface | Python scripting and automation |
 
-The `ghidra` user only has permissions to the following directories inside the container:
-- `/ghidra`
-- `/home/ghidra`
+The `entrypoint.sh` script executes upon container startup and routes to the appropriate Ghidra component based on `MODE`.
 
+## Configuration
 
-When a container does not receive any arguments passed to it with the `docker run` command,
-the corresponding Command Line Interface (CLI) for the `MODE` executed will display it's usage statement.
+### Container User and Permissions
 
-### Mapping Local Volumes to a Container
+Ghidra runs as user `ghidra` (UID/GID `1001:1001`) inside the container for security reasons.
 
-Volumes within the container may run into permission issues if the volumes are not accessible by users in the group id `1001`.
+**Writable directories:**
+- `/ghidra` - Ghidra installation directory
+- `/home/ghidra` - User home directory (recommended for projects)
 
-The default uid and guid for the container is `1001:1001`. Volumes that get mapped to the container should be accessible by this uid/guid.
+### Volume Mounting
 
-Adding the host machine's user to the group `1001` on the host helps manage volumes that will be used in the container.
-This can easily be done by executing `sudo usermod -aG 1001 <user>` on Linux.
+When mounting volumes, ensure proper permissions:
 
-### Example of Headless Mode
+**Linux:**
+```bash
+# Add your user to group 1001
+sudo usermod -aG 1001 $USER
 
+# Set permissions on directories you'll mount
+sudo chown -R :1001 /path/to/myproject
+sudo chmod -R g+w /path/to/myproject
 ```
+
+**macOS/Windows:**
+Docker Desktop handles permissions automatically, but you may need to adjust file permissions within the container.
+
+### Environment Variables
+
+| Variable | Default | Description |
+|----------|---------|-------------|
+| `MODE` | `gui` | Execution mode (see [Container Modes](#container-modes)) |
+| `MAXMEM` | `2G` | Maximum Java heap size (e.g., `4G`, `8192M`) |
+| `LAUNCH_MODE` | `fg` | Launch mode: `fg` (foreground) or `bg` (background) |
+| `DEBUG_ADDRESS` | `127.0.0.1:13002` | Debug server address for headless mode |
+| `VMARG_LIST` | Varies by mode | Additional JVM arguments |
+| `DISPLAY` | (unset) | X11 display for GUI mode |
+
+### Port Mapping
+
+Common ports used by Ghidra services:
+
+| Service | Container Port | Description |
+|---------|---------------|-------------|
+| Ghidra Server | 13100-13102 | Server communication ports |
+| BSIM Server | 5432 | PostgreSQL database port |
+| Debug Server | 13002 | Remote debugging port |
+
+Example port mapping:
+```bash
+-p 13100:13100 -p 13101:13101 -p 13102:13102
+```
+
+## Usage Examples
+
+### Headless Mode
+
+Headless mode is ideal for automated analysis, CI/CD pipelines, and batch processing.
+
+#### Basic Analysis
+
+```bash
 docker run \
     --env MODE=headless \
     --rm \
@@ -64,146 +185,795 @@ docker run \
     /home/ghidra/myproject programFolder -import /home/ghidra/mybinary
 ```
 
-Breaking this down line by line:
-- `docker run` is going to start a docker container using the image `ghidra/ghidra<:<version>`
-- `--env MODE=headless` configures the environment variable `MODE` within the container to be the value `headless`
-- `--rm` removes the container after the command is complete
-- `--volume /path/to/myproject:/home/ghidra/myproject` mounts the local volume 
-	`/path/to/myproject` on the host to `/home/ghidra/myproject` within the container
-- `--volume /path/to/mybinary:/home/ghidra/mybinary` mounts the local volume 
-	`/path/to/mybinary` on the host to `/home/ghidra/mybinary` within the container
-- `ghidra/ghidra:<version>` is the full reference for the docker image, where `ghidra/ghidra` is the group and name of the image, and `<version>` is the tag.
-- `/home/ghidra/myproject programFolder -import /home/ghidra/mybinary` are arguments being passed to Ghidra's headless analyzer's command line interface
+**Command breakdown:**
+- `--env MODE=headless` - Sets execution mode to headless analyzer
+- `--rm` - Automatically removes container after execution
+- `--volume` - Mounts host directories into container
+- Arguments after image name are passed to `analyzeHeadless`
 
-Passing no arguments will result in the usage of the headless analyzer being displayed. 
+#### With Analysis Scripts
 
-`/path/to/myproject` on the host must be accessible to guid `1001` with `rwx` permissions.
+```bash
+docker run \
+    --env MODE=headless \
+    --rm \
+    --volume /path/to/myproject:/home/ghidra/myproject \
+    --volume /path/to/mybinary:/home/ghidra/mybinary \
+    --volume /path/to/scripts:/home/ghidra/scripts \
+    ghidra/ghidra:<version> \
+    /home/ghidra/myproject programFolder \
+    -import /home/ghidra/mybinary \
+    -scriptPath /home/ghidra/scripts \
+    -postScript MyScript.java
+```
 
-### Example of Gui Mode
+#### With Custom Memory Settings
 
-Running Ghidra's Graphical User Interface (GUI) in the docker container is not a recommended method for running Ghidra.
-GUI's are not a typical use case for dockerized applications.
+```bash
+docker run \
+    --env MODE=headless \
+    --env MAXMEM=8G \
+    --rm \
+    --volume /path/to/myproject:/home/ghidra/myproject \
+    --volume /path/to/mybinary:/home/ghidra/mybinary \
+    ghidra/ghidra:<version> \
+    /home/ghidra/myproject programFolder -import /home/ghidra/mybinary
+```
 
+#### Batch Processing Multiple Binaries
+
+```bash
+for binary in /path/to/binaries/*; do
+    docker run \
+        --env MODE=headless \
+        --rm \
+        --volume /path/to/myproject:/home/ghidra/myproject \
+        --volume "$binary:/home/ghidra/$(basename $binary)" \
+        ghidra/ghidra:<version> \
+        /home/ghidra/myproject "$(basename $binary)" -import "/home/ghidra/$(basename $binary)"
+done
 ```
+
+**Note:** The project directory on the host must be accessible to GID `1001` with `rwx` permissions. Passing no arguments displays the headless analyzer usage.
+
+### GUI Mode
+
+> **⚠️ Warning:** Running Ghidra's GUI in Docker is not recommended. GUI applications are not typical use cases for containerized applications. Consider using headless mode or running Ghidra natively for GUI access.
+
+If you must run the GUI in Docker, you'll need X11 forwarding:
+
+#### Linux with X11
+
+```bash
+# Allow X11 connections (one-time setup)
+xhost +local:docker
+
+# Run GUI
 docker run \
     --env MODE=gui \
     -it \
     --rm \
     --net host \
-    --env DISPLAY \
-    --volume "$HOME/.Xauthority:/home/ghidra/.Xauthority" \
+    --env DISPLAY=$DISPLAY \
+    --volume "$HOME/.Xauthority:/home/ghidra/.Xauthority:ro" \
+    --volume /path/to/myproject:/home/ghidra/myproject \
+    --volume /path/to/mybinary:/home/ghidra/mybinary \
     ghidra/ghidra:<version>
 ```
 
-In this mode, the container relies on X11 forwarding to display the GUI. Configuration of X11 can vary, but in this case,
-the host's Xauthority file is mounted into the container, the container is configured to use the host's network, and the DISPLAY
-environment variable is passed to the container. This enables forwarding the GUI back to the host machine's display. Volumes 
-containing binaries would still need to be mounted to the container as well as volumes for ghidra projects. 
+**Requirements:**
+- X11 server running on host
+- `.Xauthority` file must be readable by GID `1001`
+- `DISPLAY` environment variable set on host
+
+**Setting Xauthority permissions:**
+```bash
+chgrp 1001 ~/.Xauthority
+chmod g+r ~/.Xauthority
+```
 
-The host's `.Xauthority` file must have appropriate permissions - assigned the group`:1001` with `rw` group permissions.
+#### macOS with XQuartz
 
+```bash
+# Install XQuartz if not already installed
+brew install --cask xquartz
 
-### Example of Ghidra Server Mode
+# Allow connections from Docker
+xhost + 127.0.0.1
 
+# Run GUI
+docker run \
+    --env MODE=gui \
+    -it \
+    --rm \
+    --env DISPLAY=host.docker.internal:0 \
+    --volume /path/to/myproject:/home/ghidra/myproject \
+    ghidra/ghidra:<version>
 ```
+
+
+### Ghidra Server Mode
+
+Ghidra Server enables multi-user collaboration with shared repositories.
+
+#### Basic Server Setup
+
+```bash
 docker run \
     --env MODE=ghidra-server \
-    --rm \
-    -it \
-    --volume /path/to/my/repositories:/ghidra/repositories \
-    --volume /path/to/my/configs/server.conf:/ghidra/server/server.conf \
+    -d \
+    --name ghidra-server \
+    --restart unless-stopped \
+    --volume /path/to/repositories:/ghidra/repositories \
+    --volume /path/to/server.conf:/ghidra/server/server.conf \
     -p 13100:13100 \
     -p 13101:13101 \
     -p 13102:13102 \
     ghidra/ghidra:<version>
 ```
 
-Volumes would need to be mounted to the server container to save the repositories, users, and also to configure the server as well.
+**Important volumes:**
+- `/ghidra/repositories` - Server repositories (must persist)
+- `/ghidra/server/server.conf` - Server configuration file
+- `/ghidra/server/svrAdmin` - Server admin tools (optional)
+
+#### Server Administration
+
+Access the server administration tools:
 
-To utilize svrAdmin, exec into the running ghidra server container (`docker exec -it <container-id> bash`) for a bash shell in the container. 
-After exec'ing into the container, administration and management of the Ghidra server is the same as outside of a containerized environment.
+```bash
+# Get container ID
+docker ps | grep ghidra-server
 
-To stop the container, execute the command `docker stop <container-id>`.
+# Execute into container
+docker exec -it <container-id> bash
+
+# Inside container, use svrAdmin
+/ghidra/server/svrAdmin
+```
 
-## Example of BSIM Server Mode
+#### Viewing Server Logs
 
+```bash
+docker logs -f ghidra-server
 ```
+
+#### Stopping the Server
+
+```bash
+docker stop ghidra-server
+docker rm ghidra-server  # if you used --rm, this isn't needed
+```
+
+#### Server Configuration
+
+Create `server.conf` on your host:
+
+```properties
+# Example server.conf
+ghidra.server.port=13100
+ghidra.server.ssl.port=13101
+ghidra.server.rmi.port=13102
+```
+
+Mount it when starting the container as shown above.
+
+### BSIM Server Mode
+
+BSIM (Binary Similarity Indexing) Server hosts a PostgreSQL database for function signature storage and querying.
+
+#### Starting BSIM Server
+
+```bash
 docker run \
     --env MODE=bsim-server \
-    --rm \
-    -it \
-    --volume /path/to/my/datadir:/ghidra/bsim_datadir \
+    -d \
+    --name bsim-server \
+    --restart unless-stopped \
+    --volume /path/to/bsim_datadir:/ghidra/bsim_datadir \
     -p 5432:5432 \
     ghidra/ghidra:<version> \
     /ghidra/bsim_datadir
 ```
 
-`/ghidra/bsim_datadir` is the directory used to store bsim's data in the container. Other directories could be used on the container,
-but make sure that the folder on the host machine has appropriate permissions, assigned the group `:1001`.
+**Important:**
+- The data directory must be accessible to GID `1001`
+- Port `5432` is the PostgreSQL default port
+- The directory path is passed as an argument to the server
+
+#### BSIM Server Administration
 
-This example simply starts a bsim server. Configuring the bsim server and populating it with data 
-could be done post start within the container in a similar way that ghidra server administration is done.
-An administrator would have to exec into the running bsim server container (`docker exec -it <container-id> bash`), 
-and after exec'ing into the container, administration and management of the Bsim server is the same as outside of a containerized environment.
+```bash
+# Access server administration
+docker exec -it bsim-server bash
+
+# Inside container, use bsim_ctl commands
+/ghidra/support/bsim_ctl
+```
 
-To stop the container, execute the command `docker stop <container-id>`.
+#### Viewing BSIM Logs
 
-## Example of BSIM CLI Mode
+```bash
+docker logs -f bsim-server
 ```
+
+### BSIM CLI Mode
+
+Use BSIM CLI to generate signatures and query the database.
+
+#### Generate Signatures from Ghidra Server
+
+```bash
 docker run \
-		--env MODE=bsim \
-		--rm \
-		 -it \
-		 ghidra/ghidra:<version> \
-		 generatesigs ghidra://ghidrasvr/demo /home/ghidra \
-			 --bsim postgresql://bsimsvr/demo \
-			 --commit --overwrite \
-			 --user ghidra
+    --env MODE=bsim \
+    --rm \
+    --network ghidra-network \
+    ghidra/ghidra:<version> \
+    generatesigs ghidra://ghidrasvr/demo /home/ghidra \
+        --bsim postgresql://bsimsvr/demo \
+        --commit --overwrite \
+        --user ghidra
+```
+
+**Command explanation:**
+- `generatesigs` - Generate function signatures
+- `ghidra://ghidrasvr/demo` - Source Ghidra server and repository
+- `/home/ghidra` - Output directory for signatures
+- `--bsim postgresql://bsimsvr/demo` - Target BSIM database
+- `--commit` - Commit signatures to database
+- `--overwrite` - Overwrite existing signatures
+
+#### Query BSIM Database
+
+```bash
+docker run \
+    --env MODE=bsim \
+    --rm \
+    --network ghidra-network \
+    ghidra/ghidra:<version> \
+    query --bsim postgresql://bsimsvr/demo \
+        --function-name "main" \
+        --similarity 0.8
 ```
 
-In this example, the bsim CLI is used to connect to a ghidra server hosted on `ghidrasvr`, 
-generate signatures for the `demo` repository in that ghidra server and save them to `/home/ghidra`. 
-and then commit the signatures to the BSIM server hosted on `bsimsvr` in the `demo` database.
 
+### PyGhidra Mode
 
-## Example of Pyghidra Gui Mode
+PyGhidra provides Python 3 scripting capabilities for Ghidra automation.
 
-Running Ghidra's Graphical User Interface (GUI) in the docker container is not a recommended method for running Ghidra.
-GUI's are not a typical use case for dockerized applications.
+#### PyGhidra Headless Mode
 
+```bash
+docker run \
+    --env MODE=pyghidra \
+    --rm \
+    --volume /path/to/myproject:/myproject \
+    --volume /path/to/mybinary:/mybinary \
+    --volume /path/to/scripts:/scripts \
+    ghidra/ghidra:<version> -H \
+    /myproject programFolder -import /mybinary \
+    -scriptPath /scripts \
+    -postScript my_script.py
 ```
+
+**Benefits over standard headless:**
+- Full Python 3 support (not just Jython)
+- Access to modern Python libraries
+- Better integration with Python tooling
+
+#### PyGhidra Interactive Mode
+
+```bash
 docker run \
     --env MODE=pyghidra \
     -it \
     --rm \
-    --net host \
-    --env DISPLAY \
-    --volume="$HOME/.Xauthority:/home/ghidra/.Xauthority:rw" \
-    ghidra/ghidra:<version> -c
+    --volume /path/to/myproject:/myproject \
+    ghidra/ghidra:<version> -i
 ```
-In this mode, the container relies on X11 forwarding to display the GUI. Configuration of X11 can vary, but in this case,
-the host's Xauthority file is mounted into the container, the container is configured to use the host's network, and the DISPLAY
-environment variable is passed to the container. This enables forwarding the GUI back to the host machine's display. Volumes 
-containing binaries would still need to be mounted to the container as well as volumes for ghidra projects. 
 
-The host's `.Xauthority` file must have appropriate permissions - owned by `:1001` with `rw` group permissions.
+#### PyGhidra GUI Mode
 
+> **⚠️ Warning:** Not recommended. See [GUI Mode](#gui-mode) warnings.
 
-## Example of Pyghidra Headless Mode
-
+```bash
+docker run \
+    --env MODE=pyghidra \
+    -it \
+    --rm \
+    --net host \
+    --env DISPLAY=$DISPLAY \
+    --volume="$HOME/.Xauthority:/home/ghidra/.Xauthority:ro" \
+    --volume /path/to/myproject:/myproject \
+    ghidra/ghidra:<version> -c
 ```
+
+#### Running Python Scripts
+
+```bash
 docker run \
     --env MODE=pyghidra \
     --rm \
     --volume /path/to/myproject:/myproject \
-    --volume /path/to/mybinary:/mybinary \
+    --volume /path/to/script.py:/script.py \
     ghidra/ghidra:<version> -H \
-    /myproject programFolder -import /mybinary
+    /myproject programFolder \
+    -scriptPath / \
+    -postScript script.py
+```
+
+## Docker Compose
+
+Docker Compose simplifies multi-container setups. Here are example configurations:
+
+### Ghidra Server with BSIM
+
+Create `docker-compose.yml`:
+
+```yaml
+version: '3.8'
+
+services:
+  ghidra-server:
+    image: ghidra/ghidra:<version>
+    container_name: ghidra-server
+    environment:
+      - MODE=ghidra-server
+    volumes:
+      - ./repositories:/ghidra/repositories
+      - ./server.conf:/ghidra/server/server.conf
+    ports:
+      - "13100:13100"
+      - "13101:13101"
+      - "13102:13102"
+    restart: unless-stopped
+    networks:
+      - ghidra-network
+
+  bsim-server:
+    image: ghidra/ghidra:<version>
+    container_name: bsim-server
+    environment:
+      - MODE=bsim-server
+    volumes:
+      - ./bsim_datadir:/ghidra/bsim_datadir
+    ports:
+      - "5432:5432"
+    command: /ghidra/bsim_datadir
+    restart: unless-stopped
+    networks:
+      - ghidra-network
+
+networks:
+  ghidra-network:
+    driver: bridge
 ```
-Passing no arguments to the pyghidra headless analyzer will result in the help menu being displayed, just like the headless analyzer.
 
-This use case is very similar to the headless mode's example with the added benefit of being able to utilize python3 for Ghidra Scripts.
+**Usage:**
+```bash
+docker-compose up -d
+docker-compose logs -f
+docker-compose down
+```
+
+### Development Environment
+
+```yaml
+version: '3.8'
+
+services:
+  ghidra-headless:
+    image: ghidra/ghidra:<version>
+    environment:
+      - MODE=headless
+      - MAXMEM=4G
+    volumes:
+      - ./projects:/home/ghidra/projects
+      - ./binaries:/home/ghidra/binaries
+      - ./scripts:/home/ghidra/scripts
+    command: /home/ghidra/projects myproject -import /home/ghidra/binaries/mybinary
+    working_dir: /home/ghidra
+    networks:
+      - ghidra-network
+
+networks:
+  ghidra-network:
+    driver: bridge
+```
+
+## Troubleshooting
+
+### Common Issues and Solutions
+
+#### Permission Denied Errors
+
+**Problem:** Container cannot write to mounted volumes.
+
+**Solution:**
+```bash
+# Check current permissions
+ls -la /path/to/mounted/directory
+
+# Fix permissions (Linux)
+sudo chown -R :1001 /path/to/mounted/directory
+sudo chmod -R g+w /path/to/mounted/directory
+
+# Or add your user to group 1001
+sudo usermod -aG 1001 $USER
+# Log out and back in for changes to take effect
+```
+
+#### Container Exits Immediately
+
+**Problem:** Container starts and immediately stops.
+
+**Solution:**
+- Check container logs: `docker logs <container-id>`
+- Ensure `MODE` environment variable is set correctly
+- Verify you're passing required arguments for the selected mode
+- For headless mode, ensure project and binary paths are correct
+
+#### Out of Memory Errors
+
+**Problem:** Java heap space errors or container being killed.
+
+**Solution:**
+```bash
+# Increase MAXMEM
+docker run --env MAXMEM=8G ...
+
+# Or limit container memory
+docker run --memory=10g --env MAXMEM=8G ...
+```
+
+#### X11 Forwarding Not Working (GUI Mode)
+
+**Problem:** GUI doesn't display or shows permission errors.
+
+**Solution:**
+```bash
+# Check X11 is running
+echo $DISPLAY
+
+# Allow Docker to connect (Linux)
+xhost +local:docker
+
+# Fix Xauthority permissions
+chgrp 1001 ~/.Xauthority
+chmod g+r ~/.Xauthority
+
+# For macOS with XQuartz
+xhost + 127.0.0.1
+```
+
+#### Port Already in Use
+
+**Problem:** Port binding fails because port is already in use.
+
+**Solution:**
+```bash
+# Find process using the port
+sudo lsof -i :13100
+
+# Use different host port
+docker run -p 13110:13100 ...
+```
+
+#### Build Fails with "application.properties not found"
+
+**Problem:** Build script can't find version information.
+
+**Solution:**
+- Ensure you're building from a **release** directory, not source
+- Verify `Ghidra/application.properties` exists
+- Run build script from the root of the release directory
+
+#### Slow Performance
+
+**Problem:** Container operations are slow.
+
+**Solutions:**
+- Use named volumes instead of bind mounts for better performance
+- Ensure Docker has sufficient resources allocated
+- Use `--memory` and `--cpus` limits appropriately
+- Consider using Docker's build cache
+
+### Debugging Tips
+
+#### Inspect Running Container
+
+```bash
+# Get container ID
+docker ps
+
+# Execute into container
+docker exec -it <container-id> bash
+
+# Check environment variables
+docker exec <container-id> env
+
+# View logs
+docker logs -f <container-id>
+```
+
+#### Test Container Entrypoint
+
+```bash
+# Override entrypoint to test
+docker run --entrypoint /bin/bash -it ghidra/ghidra:<version>
+
+# Inside container, test entrypoint manually
+MODE=headless /ghidra/docker/entrypoint.sh --help
+```
+
+#### Verbose Logging
+
+```bash
+# Enable Java verbose logging
+docker run --env VMARG_LIST="-Djava.util.logging.config.file=/ghidra/support/logging.properties" ...
+```
+
+## Security Considerations
+
+### Running as Non-Root
+
+The container runs as user `ghidra` (UID 1001) instead of root, which is a security best practice.
+
+### Network Security
+
+- **Don't expose ports unnecessarily:** Only map ports you actually need
+- **Use Docker networks:** Isolate containers using Docker networks instead of `--net host`
+- **Firewall rules:** Configure host firewall to restrict access to exposed ports
+
+### Volume Security
+
+- **Read-only mounts:** Use `:ro` suffix for volumes that don't need write access
+- **Sensitive data:** Be careful mounting directories containing sensitive information
+- **Permissions:** Ensure mounted volumes have appropriate permissions
+
+### Image Security
+
+- **Base image:** The image uses Alpine Linux, which is minimal and security-focused
+- **Updates:** Regularly rebuild images to include security updates
+- **Scanning:** Use tools like `docker scan` or Trivy to scan images for vulnerabilities
+
+```bash
+# Scan image for vulnerabilities
+docker scan ghidra/ghidra:<version>
+```
+
+### Best Security Practices
+
+1. **Don't run GUI mode in production** - Use headless mode instead
+2. **Limit container resources** - Use `--memory` and `--cpus` limits
+3. **Use secrets management** - Don't hardcode credentials in Dockerfiles
+4. **Regular updates** - Keep Docker and images updated
+5. **Network isolation** - Use Docker networks to isolate services
+6. **Read-only root filesystem** - Consider `--read-only` flag for enhanced security
+
+## Best Practices
+
+### Resource Management
+
+```bash
+# Set memory limits
+docker run --memory=8g --env MAXMEM=6G ...
+
+# Limit CPU usage
+docker run --cpus="2.0" ...
+
+# Combine both
+docker run --memory=8g --cpus="2.0" --env MAXMEM=6G ...
+```
+
+### Volume Management
+
+```bash
+# Use named volumes for better performance
+docker volume create ghidra-projects
+docker run --volume ghidra-projects:/home/ghidra/projects ...
+
+# Use read-only mounts when possible
+docker run --volume /readonly/data:/data:ro ...
+```
+
+### Container Lifecycle
+
+```bash
+# Use restart policies for long-running services
+docker run --restart unless-stopped ...
+
+# Clean up stopped containers
+docker container prune
+
+# Remove unused volumes
+docker volume prune
+```
+
+### Logging
+
+```bash
+# Use logging drivers for better log management
+docker run --log-driver json-file --log-opt max-size=10m --log-opt max-file=3 ...
+
+# View logs with timestamps
+docker logs -t <container-id>
+```
+
+### Multi-Stage Builds
+
+The Dockerfile already uses multi-stage builds. When creating custom images:
+
+```dockerfile
+# Build stage
+FROM ghidra/ghidra:<version> AS builder
+# ... build steps ...
+
+# Runtime stage
+FROM ghidra/ghidra:<version>
+COPY --from=builder /built/artifacts /ghidra/
+```
+
+## Performance Tuning
+
+### Java Memory Settings
+
+Adjust `MAXMEM` based on your workload:
+
+```bash
+# Small binaries (< 10MB)
+--env MAXMEM=2G
+
+# Medium binaries (10-100MB)
+--env MAXMEM=4G
+
+# Large binaries (> 100MB)
+--env MAXMEM=8G
+
+# Very large binaries or batch processing
+--env MAXMEM=16G
+```
+
+**Note:** Container memory should be at least 1-2GB more than `MAXMEM`.
+
+### JVM Tuning
+
+Customize JVM arguments for your workload:
+
+```bash
+# For analysis-heavy workloads
+--env VMARG_LIST="-XX:+UseG1GC -XX:MaxGCPauseMillis=200"
+
+# For memory-constrained environments
+--env VMARG_LIST="-XX:+UseSerialGC -Xms1G"
+```
+
+### Parallel Processing
+
+For batch operations, run multiple containers in parallel:
+
+```bash
+# Process binaries in parallel (adjust -P for your system)
+find /binaries -type f | xargs -n 1 -P 4 -I {} \
+  docker run --rm --env MODE=headless \
+    --volume /projects:/projects \
+    --volume {}:/binary \
+    ghidra/ghidra:<version> \
+    /projects project -import /binary
+```
+
+### Storage Optimization
+
+- Use SSD storage for project directories
+- Consider using Docker volumes on fast storage
+- Regularly clean up old projects and temporary files
+
+## Advanced Topics
+
+### Custom Entrypoint Scripts
+
+Create custom entrypoint scripts for specialized workflows:
+
+```bash
+#!/bin/bash
+# custom-entrypoint.sh
+export MODE=headless
+export MAXMEM=4G
+
+# Pre-processing
+echo "Starting analysis..."
+
+# Run Ghidra
+/ghidra/docker/entrypoint.sh "$@"
+
+# Post-processing
+echo "Analysis complete"
+```
+
+### Building Custom Images
+
+Extend the base image for custom configurations:
+
+```dockerfile
+FROM ghidra/ghidra:<version>
+
+# Install additional tools
+USER root
+RUN apk add --no-cache vim curl
+
+# Add custom scripts
+COPY my-scripts/ /home/ghidra/scripts/
+RUN chown -R ghidra:ghidra /home/ghidra/scripts
+
+USER ghidra
+```
+
+### Integration with CI/CD
+
+Example GitHub Actions workflow:
+
+```yaml
+name: Analyze Binary
+
+on: [push]
+
+jobs:
+  analyze:
+    runs-on: ubuntu-latest
+    steps:
+      - uses: actions/checkout@v2
+      - name: Run Ghidra Analysis
+        run: |
+          docker run --rm \
+            --env MODE=headless \
+            --volume $PWD:/workspace \
+            ghidra/ghidra:latest \
+            /workspace/project program -import /workspace/binary
+```
+
+### Health Checks
+
+Add health checks for long-running containers:
+
+```yaml
+# docker-compose.yml
+services:
+  ghidra-server:
+    image: ghidra/ghidra:<version>
+    healthcheck:
+      test: ["CMD", "pgrep", "-f", "ghidraSvr"]
+      interval: 30s
+      timeout: 10s
+      retries: 3
+```
+
+### Monitoring
+
+Monitor container resource usage:
+
+```bash
+# Real-time stats
+docker stats <container-id>
+
+# Export metrics
+docker stats --no-stream --format "table {{.Container}}\t{{.CPUPerc}}\t{{.MemUsage}}"
+```
+
+## Additional Resources
+
+- [Ghidra Documentation](https://ghidra-sre.org/)
+- [Docker Documentation](https://docs.docker.com/)
+- [Docker Compose Documentation](https://docs.docker.com/compose/)
+- [Ghidra GitHub Repository](https://github.com/NationalSecurityAgency/ghidra)
+
+## Getting Help
+
+- **GitHub Issues:** Report bugs and request features at [Ghidra Issues](https://github.com/NationalSecurityAgency/ghidra/issues)
+- **Documentation:** Check the main [Ghidra Documentation](https://ghidra-sre.org/)
+- **Community:** Join discussions in the Ghidra community forums
+
+---
 
-Again, in this example, appropriate permissions and group assignment for `/path/to/myproject` and `/path/to/mybinary` are necessary 
-in order to not run into permissions issues.
+**Last Updated:** See Git history for latest changes
+**Maintained by:** Ghidra Development Team
 
-- 
2.45.1

