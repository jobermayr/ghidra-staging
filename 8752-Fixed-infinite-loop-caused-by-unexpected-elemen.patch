From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: mnemonikr <138624285+mnemonikr@users.noreply.github.com>
Date: Sun, 7 Sep 2025 21:29:00 -0700
Subject: [PATCH] 8752: Fixed infinite loop caused by unexpected element when
 decoding DecisionNode

---
 Ghidra/Features/Decompiler/src/decompile/cpp/slghsymbol.cc | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/Ghidra/Features/Decompiler/src/decompile/cpp/slghsymbol.cc b/Ghidra/Features/Decompiler/src/decompile/cpp/slghsymbol.cc
index c1b48c109d..4fb4926743 100644
--- a/Ghidra/Features/Decompiler/src/decompile/cpp/slghsymbol.cc
+++ b/Ghidra/Features/Decompiler/src/decompile/cpp/slghsymbol.cc
@@ -2455,6 +2455,8 @@ void DecisionNode::decode(Decoder &decoder,DecisionNode *par,SubtableSymbol *sub
       subnode->decode(decoder,this,sub);
       children.push_back(subnode.release());
     }
+    else
+      throw DecoderError("Unexpected element " + std::to_string(subel));
     subel = decoder.peekElement();
   }
   decoder.closeElement(el);
-- 
2.45.1

