From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Sleigh-InSPECtor <sleighinspector@outlook.com>
Date: Wed, 15 May 2024 17:59:54 +0930
Subject: [PATCH] 6514: x86: Fix issue with PACKUSWB when the value to convert
 is exactly 0x00ff

---
 Ghidra/Processors/x86/data/languages/ia.sinc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/Ghidra/Processors/x86/data/languages/ia.sinc b/Ghidra/Processors/x86/data/languages/ia.sinc
index 6d9652a3ad..1d88d9a296 100644
--- a/Ghidra/Processors/x86/data/languages/ia.sinc
+++ b/Ghidra/Processors/x86/data/languages/ia.sinc
@@ -6388,7 +6388,7 @@ define pcodeop packssdw;
 #otherwise ubyte = sword
 macro sswub(sword, ubyte) {
     ubyte = (sword s> 0xff:2) * 0xff:1;
-    ubyte = ubyte + (sword s> 0:2) * (sword s< 0xff:2) * sword:1;
+    ubyte = ubyte + (sword s> 0:2) * (sword s<= 0xff:2) * sword:1;
 }
 
 :PACKUSWB      mmxreg, m64      is vexMode=0 &  mandover=0 & byte=0x0F; byte=0x67; mmxreg ... & m64
-- 
2.45.1

